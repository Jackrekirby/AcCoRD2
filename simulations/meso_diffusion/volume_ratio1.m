clear all;
clc;
x = linspace(0, 1, 100);
samples = 10000;
molecules = 1000;
y(100) = 0;
m = 0;
for relativeVolume = x
    m = m + 1;
    y(m) = std(sum(rand(molecules, samples) < relativeVolume, 1));
end
plot(x, y);
%%

y2 = [0.010665,3.1449,4.5311,5.4085,6.1763,6.909,7.5888,8.1942,8.7221,9.1841,...
    9.5975,9.9784,10.338,10.6824,11.0137,11.332,11.6365,11.9268,12.2029,...
    12.4652,12.7143,12.9503,13.1734,13.3831,13.579,13.7611,13.9293,14.0845,...
    14.2281,14.3621,14.4889,14.6108,14.73,14.8478,14.9649,15.0813,15.1957,...
    15.3063,15.4108,15.5069,15.5922,15.665,15.7242,15.7694,15.8014,15.8212,...
    15.8309,15.8324,15.828,15.8194,15.8082,15.7953,15.7808,15.7646,15.7457,...
    15.7231,15.6957,15.6623,15.6219,15.574,15.518,15.4538,15.3811,15.2998,...
    15.2096,15.1098,14.9996,14.8781,14.7444,14.5979,14.4384,14.2665,14.0835,...
    13.8914,13.6928,13.49,13.285,13.0785,12.8697,12.6559,12.4324,12.1939,11.9346,...
    11.6498,11.3377,10.9994,10.6399,10.2657,9.8833,9.4943,9.0926,8.6608,8.1746,7.6085,...
    6.949,6.2083,5.4063,4.4936,3.1074,0.012892]

%p = polyfit(x,y,20);
%y1 = polyval(p,x);

plot(x, y);
hold on;
plot(x, y2);
hold off;

% for i = 1:length(y1)
%     fprintf(y1(i) + ",");
% end

%%
meanMolecules = molecules * relativeVolume;
y = floor(normrnd(meanMolecules, y, 1, samples));
b(molecules + 1) = 0; 
for i = 1:samples
    b(y(i) + 1) = b(y(i) + 1) + 1;
end

plot(c);
hold on;
plot(b);
hold off;